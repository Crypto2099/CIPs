---
CIP: CIP-????
Title: POO (Proof of Onboarding) Protocol
Status: Proposed
Category: Wallets
Authors:
- Adam Dean <adam@crypto2099.io>
- Carl <vegas@hosky.io>
- Alex Dochioiu <@alexdochioiu>
Implementors:
- VESPR Wallet
Discussions:
- https://github.com/cardano-foundation/CIPs/pull/
Created: 2023-06-20
License: CC-BY-4.0
---

# Abstract

Since at least 2021 when Cardano entered the Mary Era and implemented Native Assets, projects and creators building on
the network have sought a means to distribute their tokens efficiently to users. Of particular frustration has been the
ability to onboard new users at real-world events. Solutions for this historically have been to create and preload 
"paper wallets" where a seed phrase and accompanying password is generated by the project, pre-populated with tokens and
ADA, and then delivered over to attendees of said event.

The creation of this addendum to the CIP-13 Cardano URI scheme seeks to minimize this friction and take advantage of
existing technology to enable a new era of user onboarding, particularly at real world events through the use of a
defined URI scheme enabling instant and frictionless communication between a project's "token fountain" and the user's
wallet to reward, incentivize, and onboard new users easier than ever.

This CIP defines an extension to the CIP-13 URI Scheme as well as an API specification to facilitate and streamline
communications between wallets and project servers.

# Motivation: Why is this CIP necessary?

By leveraging the power of Cardano-specific URIs (CIP-13) and the modern technological advances of mobile devices and 
wallets we can provide a framework for Cardano projects to attend real world events, incentivize or reward attendees via
their Native Assets, and have facts and figures to help support and analyze the impact that their attendance had (Proof
of Onboarding).

Furthermore, the aforementioned "paper wallet" technique has many drawbacks including:
* The person(s) responsible for generating the paper wallets at some point have access to the seed phrases generated, leading to a potential security vulnerability
* Projects would need to preload these wallets with funds/tokens; this makes it difficult and/or impossible to reliably know how many of the paper wallets were ever actually claimed
* For those wallets that go forever unclaimed, this essentially creates a permanent "burn" of both Lovelace and the native assets of the project; less than ideal

We feel that this is necessary as a CIP in order to minimize friction for new projects while maximizing compatibility
across the wide spectrum of Cardano wallets.

# Specification

Additional specifications for this CIP relevant to CIP-13 have been made under the heading of "Token Claim URI" under 
its [README.md](../CIP-0013/README.md)

## Process Flow

The envisioned process flow for the POO Protocol is as follows:
1. The project set asides some amount of budget (tokens + Lovelace [minUTxO]) for a given marketing push or IRL event
2. If desired, one or more `codes` are generated to help track and analyze claiming figures
3. QR Code(s) may be generated, printed, and otherwise displayed or given to users during the course of events
4. Users scan the code with their mobile light wallet
5. The light wallet makes a POST request to the API endpoint specified in the Cardano URI containing the user's wallet address and the included code (if present)
6. The project API returns a documented status code indicating the success or failure of the operation
7. If a successful status is detected and returned, the project issues tokens to the specified address per their campaign settings

## URI Format

The URI format simply consists of the CIP-13 `web+cardano://` format, followed by the `claim` authority.

The URI should have at least one required argument `URL` which specifies the API path to contact for an expected API
response and may optionally include a `CODE` argument which may be unique or campaign-specific depending on the needs of
the project.

**Note:** The URL argument should not contain protocol information as it should always be assumed and required to use
HTTPS:// protocol for all requests.

_Examples:_
```html 
<!-- A Cardano Claim URI with only the URL specified -->
<a href="web+cardano://claim?URL=claim.hosky.io">Claim $HOSKY Now!</a>

<!-- A Cardano Claim URI with the URL specified and a campaign-specific CODE -->
<a href="web+cardano://claim?URL=claim.nftxlv.com&CODE=NFTxLV2023">Claim your NFTxLV 2023 NFT now!</a>

<!-- A Cardano Claim URI with the URL specified and a unique, one-time use CODE -->
<a href="web+cardano://claim?URL=claim.hosky.io&CODE=ABC123">Claim Some $HOSKY!</a>
```

## Wallet Requests

Light wallets that detect and support `web+cardano` URIs as well as mobile wallets who detect either a QR code or other
link with this format should parse the URI should send a `POST` request to the specified URL containing a JSON payload
including:
* The user's wallet receive address
* The code (if present in the URI)

_Examples:_
```json 
URI: web+cardano://claim?URL=claim.hosky.io
URL: https://claim.hosky.io
POST JSON Data:
{
  "address": "addr1abc...xyz"
}

URI: web+cardano://claim?URL=claim.nftxlv.com&CODE=NFTxLV2023
URL: https://claim.nftxlv.com
JSON POST Data:
{
  "address": "addr1abc...xyz",
  "code": "NFTxLV2023"
}

URI: web+cardano://claim?URL=claim.hosky.io&CODE=ABC123
URL: https://claim.hosky.io
POST JSON Data:
{
  "address": "addr1abc...xyz",
  "code": "ABC123"
}
```

## API Server Response Codes

### Successful Responses

#### Valid (200)

First Successful Request

```json
{
  "code": 200,
  "lovelaces": 2000000,
  "queue_position": 1,
  "status": "accepted",
  "tokens": {
    "a0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235.HOSKY": "29433292.000000"
  }
}
```

#### Valid Queued (201)

Subsequent Successful Request (Address + Code Match) prior to token distribution

```json
{
  "code": 201,
  "lovelaces": 2000000,
  "queue_position": 1,
  "status": "queued",
  "tokens": {
    "a0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235.HOSKY": "29433292.000000"
  }
}
```

#### Valid Complete (202)

Subsequent Successful Request (Address + Code Match) after token(s) are distributed

```json
{
  "code": 202,
  "lovelaces": 2000000,
  "status": "claimed",
  "tokens": {
    "a0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235.HOSKY": "29433292.000000"
  },
  "tx_hash": "TX1234"
}
```

### Error Responses

#### Invalid - Not Known (404)

The specified code does not exist

```json
{
  "code": 404,
  "status": "notfound"
}
```

#### Invalid - Already Claimed (409)

An address was already used (if not code present) or the code presented was found but the address did not match

```json
{
  "code": 409,
  "status": "alreadyclaimed"
}
```

#### Invalid - Expired (410)

For time-limited fountains, a code of 410 means that the period for redemption has expired

```json 
{
  "code": 410,
  "status": "expired"
}
```

#### Invalid - Too Early (425)

For time-limited fountains, a code of 425 means that the period for redemption has not begun yet

```json
{
  "code": 425,
  "status": "tooearly"
}
```

#### Invalid - Rate Limited (429)

Rate limiting settings and details are left to the discretion and implementation of individual projects. A status code
of 429 or this status response should be considered as a rate limiting response.

```json
{
  "code": 429,
  "status": "ratelimited"
}
```

#### Server Error (500)

Implementations should of course be prepared to handle situations where a server is non-responsive for any reason and 
be prepared to handle any other, non-specified error codes including 500 codes.

# Rationale

By creating a well-defined standard for both a CIP-13 URI scheme and the expected API response(s) we can create a 
framework that both wallets and projects can utilize to encourage and onboard new users into the ecosystem via Native
Asset incentive models without needlessly and constantly reinventing the wheel for each product or project.

By utilizing this framework, projects can have accurate, measurable analytics into the success of various real-world 
marketing and event efforts: Proof of Onboarding.

# Path to Active

## Acceptance Criteria

- [ ] Demonstrate a working MVP including open source code
- [ ] Receive and iterate based on community feedback

## Implementation Plan

In order to encourage adoption of this standard the authors commit to execute a functional a minimum viable product 
proof of concept demonstration in partnership between Adam Dean, HOSKY Token, and VESPR wallet. This real-world
implementation should give us important insight on whether the system requires additional modifications or changes.

From there we will do our best to engage with other teams and projects in the ecosystem to encourage and support
adoption of this standard on a larger scale.

# Copyright

This CIP is licensed under [CC-BY-4.0](https://creativecommons.org/licenses/by/4.0/legalcode).